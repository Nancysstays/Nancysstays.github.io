<!DOCTYPE html>
<html>
<head>
  <title>Nancy's Cart</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <!-- script src="script-calc.js"></script -->
  <script src="index.js"></script>
</head>
<body>

  <div id="plot"></div>

  <h2>Add Line</h2>
  X-Start: <input type="number" id="xStart" placeholder="Enter starting x"> 
  X-End: <input type="number" id="xEnd" placeholder="Enter ending x"> 
  Y-Start: <input type="number" id="yStart" placeholder="Enter starting y"> 
  Y-End: <input type="number" id="yEnd" placeholder="Enter ending y"> 
  <button onclick="addLine()">Add Line</button>

  <h2>Lines</h2>
  <ul id="lineList"></ul>

  <button onclick="saveState()">Save</button>
  <button onclick="loadState()">Load</button>
  <div id="content"></div>

    <div class="calculator">
        <input type="text" id="result" readonly>
        <table>
            <tr>
                <td><button onclick="appendNumber('7')">7</button></td>
                <td><button onclick="appendNumber('8')">8</button></td>
                <td><button onclick="appendNumber('9')">9</button></td>
                <td><button onclick="setOperator('+')">+</button></td>
            </tr>
            <tr>
                <td><button onclick="appendNumber('4')">4</button></td>
                <td><button onclick="appendNumber('5')">5</button></td>
                <td><button onclick="appendNumber('6')">6</button></td>
                <td><button onclick="setOperator('-')">-</button></td>
            </tr>
            <tr>
                <td><button onclick="appendNumber('1')">1</button></td>
                <td><button onclick="appendNumber('2')">2</button></td>
                <td><button onclick="appendNumber('3')">3</button></td>
                <td><button onclick="setOperator('*')">*</button></td>
            </tr>
            <tr>
                <td><button onclick="appendNumber('0')">0</button></td>
                <td><button onclick="appendNumber('.')">.</button></td>
                <td><button onclick="calculate()">=</button></td>
                <td><button onclick="setOperator('/')">/</button></td>
            </tr>
            <tr>
                <td colspan="4"><button onclick="clearResult()">C</button></td>
            </tr>
        </table>
    </div>
    <script src="script.js"></script>
</body>
</html>


</head>
<body>

  <div id="plot"></div>

  <h2>Add Line</h2>
  X-Start: <input type="number" id="xStart" placeholder="Enter starting x"> 
  X-End: <input type="number" id="xEnd" placeholder="Enter ending x"> 
  Y-Start: <input type="number" id="yStart" placeholder="Enter starting y"> 
  Y-End: <input type="number" id="yEnd" placeholder="Enter ending y"> 
  <button onclick="addLine()">Add Line</button>

  <h2>Lines</h2>
  <ul id="lineList"></ul>

  <button onclick="saveState()">Save</button>
  <button onclick="loadState()">Load</button>

  <div class="calculator">
    <input type="text" id="result" readonly>
    <table>
      <tr>
        <td><button onclick="appendNumber('7')">7</button></td>
        <td><button onclick="appendNumber('8')">8</button></td>
        <td><button onclick="appendNumber('9')">9</button></td>
        <td><button onclick="setOperator('+')">+</button></td>
      </tr>
      <tr>
        <td><button onclick="appendNumber('4')">4</button></td>
        <td><button onclick="appendNumber('5')">5</button></td>
        <td><button onclick="appendNumber('6')">6</button></td>
        <td><button onclick="setOperator('-')">-</button></td>
      </tr>
      <tr>
        <td><button onclick="appendNumber('1')">1</button></td>
        <td><button onclick="appendNumber('2')">2</button></td>
        <td><button onclick="appendNumber('3')">3</button></td>
        <td><button onclick="setOperator('*')">*</button></td>
      </tr>
      <tr>
        <td><button onclick="appendNumber('0')">0</button></td>
        <td><button onclick="appendNumber('.')">.</button></td>
        <td><button onclick="calculate()">=</button></td>
        <td><button onclick="setOperator('/')">/</button></td>
      </tr>
      <tr>
        <td colspan="4"><button onclick="clearResult()">C</button></td>
      </tr>
    </table>
  </div>

  <script>
    let data = [];
    let counter = 1;
    let color = 'blue'; 

    // Initialize Plotly with aspect ratio maintained
    function initializePlot() {
      let layout = {
        yaxis: {
          scaleanchor: "x",
          scaleratio: 1 
        }
      };
      Plotly.newPlot('plot', data, layout);
    }

    initializePlot();

    function addLine() {
      let xStart = parseFloat(document.getElementById('xStart').value);
      let xEnd = parseFloat(document.getElementById('xEnd').value);
      let yStart = parseFloat(document.getElementById('yStart').value);
      let yEnd = parseFloat(document.getElementById('yEnd').value);

      if (isNaN(xStart) || isNaN(xEnd) || isNaN(yStart) || isNaN(yEnd)) {
        alert("Please enter valid numbers for x and y values.");
        return;
      }

      let newLine = {
        x: [xStart, xEnd],
        y: [yStart, yEnd],
        type: 'scatter',
        mode: 'lines+markers',
        name: 'Line ' + counter,
        line: { color: color, shape: 'linear' }
      };

      data.push(newLine);
      counter++;
      Plotly.react('plot', data);
      addLineToList(newLine);

      document.getElementById('xStart').value = '';
      document.getElementById('xEnd').value = '';
      document.getElementById('yStart').value = '';
      document.getElementById('yEnd').value = '';
    }

    function addLineToList(line) {
      let lineList = document.getElementById('lineList');
      let li = document.createElement('li');
      li.id = 'line-' + (counter - 1);
      li.textContent = line.name + 
                       ' (x: ' + line.x[0] + ' to ' + line.x[1] + 
                       ', y: ' + line.y[0] + ' to ' + line.y[1] + ') ';

      let editBtn = document.createElement('button');
      editBtn.textContent = 'Edit';
      editBtn.onclick = () => editLine(line.name);
      li.appendChild(editBtn);

      let deleteBtn = document.createElement('button');
      deleteBtn.textContent = 'Delete';
      deleteBtn.onclick = () => deleteLine(line.name);
      li.appendChild(deleteBtn);

      lineList.appendChild(li);
    }

    function editLine(lineName) {
      let lineIndex = data.findIndex(line => line.name === lineName);

      if (lineIndex !== -1) {
        let line = data[lineIndex];
        document.getElementById('xStart').value = line.x[0];
        document.getElementById('xEnd').value = line.x[1];
        document.getElementById('yStart').value = line.y[0];
        document.getElementById('yEnd').value = line.y[1];

        data.splice(lineIndex, 1);
        let lineItem = document.getElementById('line-' + (lineIndex + 1));
        lineItem.remove();
        Plotly.react('plot', data); 
      }
    }

    function deleteLine(lineName) {
      let lineIndex = data.findIndex(line => line.name === lineName);

      if (lineIndex !== -1) {
        data.splice(lineIndex, 1);
        let lineItem = document.getElementById('line-' + (lineIndex + 1));
        lineItem.remove();
        Plotly.react('plot', data);
      }
    }

    function saveState() {
      localStorage.setItem('plotData', JSON.stringify(data));
    }

    function loadState() {
      let savedData = localStorage.getItem('plotData');
      if (savedData) {
        data = JSON.parse(savedData);
        counter = data.length + 1; 
        Plotly.react('plot', data);

        let lineList = document.getElementById('lineList');
        lineList.innerHTML = ''; 
        data.forEach(line => addLineToList(line));
      }
    }

    // Calculator functions
    let currentInput = '';
    let operator = null;
    let previousInput = '';

    function appendNumber(number) {
      currentInput += number;
      document.getElementById('result').value = currentInput;
    }

    function setOperator(op) {
      operator = op;
      previousInput = currentInput;
      currentInput = '';
    }

    function calculate() {
      let result;
      const num1 = parseFloat(previousInput);
      const num2 = parseFloat(currentInput);

      switch (operator) {
        case '+':
          result = num1 + num2;
          break;
        case '-':
          result = num1 - num2;
          break;
        case '*':
          result = num1 * num2;
          break;
        case '/':
          result = num1 / num2;
          break;
        default:
          return;
      }

      currentInput = result.toString();
      document.getElementById('result').value = currentInput;
      operator = null;
      previousInput = '';
    }

    function clearResult() {
      currentInput = '';
      operator = null;
      previousInput = '';
      document.getElementById('result').value = '';
    }
  </script>
