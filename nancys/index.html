<!DOCTYPE html>
<html>
<head>
  <title>Cartesian Plot with CRUD</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>

  <div id="plot"></div>

  <h2>Add Line</h2>
  X: <input type="text" id="xInput" placeholder="Enter x values (comma-separated)"> 
  Y: <input type="text" id="yInput" placeholder="Enter y values (comma-separated)"> 
  <button onclick="addLine()">Add Line</button>

  <h2>Lines</h2>
  <ul id="lineList"></ul>

  <script>
    let data = []; // Store Plotly data
    let counter = 1; // Keep track of line IDs

    // Initialize Plotly chart
    Plotly.newPlot('plot', data);

    function addLine() {
      let xStr = document.getElementById('xInput').value;
      let yStr = document.getElementById('yInput').value;

      // Basic input validation (you'll want more robust error handling)
      if (!xStr || !yStr) {
        alert("Please enter x and y values.");
        return;
      }

      let xValues = xStr.split(',').map(Number);
      let yValues = yStr.split(',').map(Number);

      let newLine = {
        x: xValues,
        y: yValues,
        type: 'scatter',
        mode: 'lines+markers',
        name: 'Line ' + counter,
        line: {shape: 'linear'} // 'spline' for curved lines
      };

      data.push(newLine);
      counter++;

      // Update Plotly chart
      Plotly.react('plot', data);

      // Add line to list with CRUD controls
      addLineToList(newLine);

      // Clear input fields
      document.getElementById('xInput').value = '';
      document.getElementById('yInput').value = '';
    }

    function addLineToList(line) {
      let lineList = document.getElementById('lineList');
      let li = document.createElement('li');
      li.id = 'line-' + (counter - 1); // Assign ID to list item
      li.textContent = line.name + ' (x: ' + line.x.join(', ') + ', y: ' + line.y.join(', ') + ') ';

      // Edit button
      let editBtn = document.createElement('button');
      editBtn.textContent = 'Edit';
      editBtn.onclick = () => editLine(line.name);
      li.appendChild(editBtn);

      // Delete button
      let deleteBtn = document.createElement('button');
      deleteBtn.textContent = 'Delete';
      deleteBtn.onclick = () => deleteLine(line.name);
      li.appendChild(deleteBtn);

      lineList.appendChild(li);
    }

    function editLine(lineName) {
      // Find the line in the data array
      let lineIndex = data.findIndex(line => line.name === lineName);

      if (lineIndex !== -1) {
        // Get the line data
        let line = data[lineIndex];

        // Pre-fill input fields with existing data
        document.getElementById('xInput').value = line.x.join(', ');
        document.getElementById('yInput').value = line.y.join(', ');

        // Remove the line from the data array
        data.splice(lineIndex, 1);

        // Remove the line from the list
        let lineItem = document.getElementById('line-' + (lineIndex + 1));
        lineItem.remove();

        // Update the Plotly chart
        Plotly.react('plot', data);
      }
    }


    function deleteLine(lineName) {
      // Find the index of the line to delete
      let lineIndex = data.findIndex(line => line.name === lineName);

      if (lineIndex !== -1) {
        // Remove the line from the data array
        data.splice(lineIndex, 1);

        // Remove the line from the list
        let lineItem = document.getElementById('line-' + (lineIndex + 1));
        lineItem.remove();

        // Update the Plotly chart
        Plotly.react('plot', data);
      }
    }
  </script>

</body>
</html>
