<!DOCTYPE html>
<html>
<head>
<title>Alpha Vantage Stock Data to CSV</title>
</head>
<body>

<script>
const url = 'https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=IBM&apikey=XVYHOWRTRNPN3FJA'; 

fetch(url)
  .then(response => response.json())
  .then(data => {
    const timeSeries = data['Time Series (Daily)'];
    let csvContent = "Date,Open,High,Low,Close,Volume\n"; 

    for (const date in timeSeries) {
      const row = `${date},${timeSeries[date]['1. open']},${timeSeries[date]['2. high']},${timeSeries[date]['3. low']},${timeSeries[date]['4. close']},${timeSeries[date]['5. volume']}\n`;
      csvContent += row;
    }

    const encodedUri = encodeURI(csvContent);
    const link = document.createElement("a");
    link.setAttribute("href", 'data:text/csv;charset=utf-8,' + encodedUri);
    link.setAttribute("download", "ibm_stock_data.csv");
    document.body.appendChild(link); 

    link.click(); 
  })
  .catch(error => console.error('Error fetching data:', error));
</script>

</body>
</html>
